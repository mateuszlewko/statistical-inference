dane1 <- read.csv("w-03-01.csv")
dane1 <- as.matrix(read.csv("w-03-01.csv"))
dane1
summary(dane1)
dane1 <- as.matrix(read.csv("w-03-01.csv", sep=';'))
summary(dane1)
history
history()
summary(dane1)
summary(dane1)
dane1
dane1[0]
dane1[0,]
dane1[1,]
dane1[1,:]
dane1[1,]
dane1[2,]
dane1[,0]
dane1[,1]
var(dane1[,1])
dane1[,2]
var(dane1[,2])
var(dane1[,2])
se <- function(x) sqrt(var(x) / length(x))
se(dane1[,2])
se(dane1[,1])
dane1[,1]
18 / dane1[,1]
18 / mean(dane1[,1])
7 / mean(dane1[,2])
test_a4 <- function (X, Y) {
dane1[,1]
X <- dane1[,1]
X
var(X)
X - mean(X)
sum((X - mean(X))^2)
sum((X - mean(X))^2) / 9
sum((X - mean(X))^2) / 10
var(X)
nrow(X)
length(X)
sum((X - mean(X))^2) / 8
var(X)
test_a4 <- function(X, Y) {
    nx <- length(X)
    ny <- length(Y)
    s2x <- var(X)
    s2y <- var(Y)
    # s <- ((nx - 1) * s2x + (ny - 1) * s2y) / (nx + ny - 2)
    a <- s2x / nx + s2y / ny
    t <- (mean(X) - mean(Y)) / sqrt(a)
    n <- a^2 / (s2x^2 / (nx^2 * (nx - 1)) + s2y^2 / (ny^2 * (ny - 1)))
    printf("t = %.4f; qt(0.975, df=%d) = %.4f; pt(%.4f, df=%d) = %.4f",
           t, n, qt(0.975, df=n), t, n, pt(t, df=n))
}
test_a4(X, Y)
Y <- dane1[,2]
test_a4(X, Y)
printf <- function(...) cat(sprintf(...))
test_a4(X, Y)
printf <- function(...) cat(sprintf(...))
test_a4 <- function(X, Y) {
    nx <- length(X)
    ny <- length(Y)
    s2x <- var(X)
    s2y <- var(Y)
    # s <- ((nx - 1) * s2x + (ny - 1) * s2y) / (nx + ny - 2)
    a <- s2x / nx + s2y / ny
    t <- (mean(X) - mean(Y)) / sqrt(a)
    n <- a^2 / (s2x^2 / (nx^2 * (nx - 1)) + s2y^2 / (ny^2 * (ny - 1)))
    n <- as.integer(n)
    printf("t = %.4f; qt(0.975, df=%d) = %.4f; pt(%.4f, df=%d) = %.4f",
           t, n, qt(0.975, df=n), t, n, pt(t, df=n))
}
test_a4 <- function(X, Y) {
test_a4(X, Y)
test_a4 <- function(X, Y) {
    nx <- length(X)
    ny <- length(Y)
    s2x <- var(X)
    s2y <- var(Y)
    # s <- ((nx - 1) * s2x + (ny - 1) * s2y) / (nx + ny - 2)
    a <- s2x / nx + s2y / ny
    t <- (mean(X) - mean(Y)) / sqrt(a)
    n <- a^2 / (s2x^2 / (nx^2 * (nx - 1)) + s2y^2 / (ny^2 * (ny - 1)))
    n <- as.integer(n)
    printf("t = %.4f; qt(0.975, df=%d) = %.4f; pt(%.4f, df=%d) = %.4f\n",
           t, n, qt(0.975, df=n), t, n, pt(t, df=n))
}
test_a4(X, Y)
# test dwóch średnich, wariancje nieznane i różne
test_a4 <- function(X, Y) {
    nx <- length(X)
    ny <- length(Y)
    s2x <- var(X)
    s2y <- var(Y)
    # s <- ((nx - 1) * s2x + (ny - 1) * s2y) / (nx + ny - 2)
    a <- s2x / nx + s2y / ny
    t <- (mean(X) - mean(Y)) / sqrt(a)
    n <- a^2 / (s2x^2 / (nx^2 * (nx - 1)) + s2y^2 / (ny^2 * (ny - 1)))
    n <- as.integer(n)
    printf("t = %.4f; qt(0.975, df=%d) = %.4f; pt(%.4f, df=%d) = %.4f\n",
           t, n, qt(0.975, df=n), t, n, pt(t, df=n))
    half <- mean(X) - mean(Y)
    left <- half - qt(0.975, df=n) * sqrt(a)
    right <- half + qt(0.975, df=n) * sqrt(a)
    printf("half: %.4f, left: %.4f, right: %.4f\n", half, left, right)
}
test_a4(X, Y)
 nx <- length(X)
    ny <- length(Y)
    s2x <- var(X)
    s2y <- var(Y)
    # s <- ((nx - 1) * s2x + (ny - 1) * s2y) / (nx + ny - 2)
    a <- s2x / nx + s2y / ny
    t <- (mean(X) - mean(Y)) / sqrt(a)
    n <- a^2 / (s2x^2 / (nx^2 * (nx - 1)) + s2y^2 / (ny^2 * (ny - 1)))
    n <- as.integer(n)
    printf("t = %.4f; qt(0.975, df=%d) = %.4f; pt(%.4f, df=%d) = %.4f\n",
           t, n, qt(0.975, df=n), t, n, pt(t, df=n))
    half <- mean(X) - mean(Y)
    left <- half - qt(0.975, df=n) * sqrt(a)
    right <- half + qt(0.975, df=n) * sqrt(a)
    printf("half: %.4f, left: %.4f, right: %.4f\n", half, left, right)
 left <- half - qt(0.975, df=n) * sqrt(a)
left
q
a
sqrt(q)
sqrt(a)
s2x
s2x / nx
s2x / nx + s2y / ny
(s2x / nx + s2y / ny)^2
a
(s2x / nx + s2y / ny)
a
sqrt(a)
X - Y
mean(X) - mean(Y)
test_a4 <- function(X, Y) {
    nx <- length(X)
    ny <- length(Y)
    s2x <- var(X)
    s2y <- var(Y)
    # s <- ((nx - 1) * s2x + (ny - 1) * s2y) / (nx + ny - 2)
    a <- s2x / nx + s2y / ny
    t <- (mean(X) - mean(Y)) / sqrt(a)
    n <- a^2 / (s2x^2 / (nx^2 * (nx - 1)) + s2y^2 / (ny^2 * (ny - 1)))
    n <- as.integer(n)
    printf("t = %.4f; qt(0.975, df=%d) = %.4f; pt(%.4f, df=%d) = %.4f\n",
           t, n, qt(0.975, df=n), t, n, pt(t, df=n))
    half <- mean(X) - mean(Y)
    left <- half - qt(0.025, df=n) * sqrt(a)
    right <- half + qt(0.025, df=n) * sqrt(a)
    printf("half: %.4f, left: %.4f, right: %.4f\n", half, left, right)
}
test_a4(X, Y)
dane <- as.matrix(read.csv("w-03-01.csv", sep=';'))
(X <- dane[,1]) # M
(Y <- dane[,2]) # K
var(X)
var(Y)
dane <- as.matrix(read.csv("w-03-02.csv", sep=';'))
(X <- dane[,1]) # M
(Y <- dane[,2]) # K
var(X)
var(Y)
read.csv("w-03-02.csv", sep=';')
var(X) / mean(X)
var(Y) / mean(Y)
( var(X) / mean(X)) / (var(Y) / mean(Y))
dane <- as.matrix(read.csv("w-03-01.csv", sep=';'))
(X <- dane[,1]) # M
(Y <- dane[,2]) # K
var(X)
var(Y)
# funkcja pomocnicza
printf <- function(...) cat(sprintf(...))
# test dwóch średnich, wariancje nieznane i różne
test_a4 <- function(X, Y, mi_diff) {
    nx <- length(X)
    ny <- length(Y)
    s2x <- var(X)
    s2y <- var(Y)
    # s <- ((nx - 1) * s2x + (ny - 1) * s2y) / (nx + ny - 2)
    a <- s2x / nx + s2y / ny
    t <- (mean(X) - mean(Y) - mi_diff) / sqrt(a)
    n <- a^2 / (s2x^2 / (nx^2 * (nx - 1)) + s2y^2 / (ny^2 * (ny - 1)))
    n <- as.integer(n)
    printf("t = %.4f; qt(0.975, df=%d) = %.4f; pt(%.4f, df=%d) = %.4f\n",
           t, n, qt(0.975, df=n), t, n, pt(t, df=n))
    half <- mean(X) - mean(Y)
    left <- half - qt(0.975, df=n) * sqrt(a)
    right <- half + qt(0.975, df=n) * sqrt(a)
    printf("half: %.4f, left: %.4f, right: %.4f\n", half, left, right)
}
test_a4(X, Y, 0)
dane <- as.matrix(read.csv("w-03-02.csv", sep=';'))
(X <- dane[,1]) # M
(Y <- dane[,2]) # K
var(X) # 7.708333
var(Y) # 9.212585
test_a4(X, Y, 2)
test_a4(X, Y, 5)
2 (1 - 0.8990)
2 * (1 - 0.8990)
test_a4(X, Y, 2)
dane <- as.matrix(read.csv("w-03-01.csv", sep=';'))
(X <- dane[,1]) # M
(Y <- dane[,2]) # K
var(X)
var(Y)
# funkcja pomocnicza
printf <- function(...) cat(sprintf(...))
# test dwóch średnich, wariancje nieznane i różne
test_a4 <- function(X, Y, mi_diff) {
    nx <- length(X)
    ny <- length(Y)
    s2x <- var(X)
    s2y <- var(Y)
    # s <- ((nx - 1) * s2x + (ny - 1) * s2y) / (nx + ny - 2)
    a <- s2x / nx + s2y / ny
    t <- (mean(X) - mean(Y) - mi_diff) / sqrt(a)
    n <- a^2 / (s2x^2 / (nx^2 * (nx - 1)) + s2y^2 / (ny^2 * (ny - 1)))
    n <- as.integer(n)
    printf("t = %.4f; qt(0.975, df=%d) = %.4f; pt(%.4f, df=%d) = %.4f\n",
           t, n, qt(0.975, df=n), t, n, pt(t, df=n))
    half <- mean(X) - mean(Y)
    left <- half - qt(0.975, df=n) * sqrt(a)
    right <- half + qt(0.975, df=n) * sqrt(a)
    printf("half: %.4f, left: %.4f, right: %.4f\n", half, left, right)
}
test_a4(X, Y, 0)
dane <- as.matrix(read.csv("w-03-02.csv", sep=';'))
(X <- dane[,1]) # M
(Y <- dane[,2]) # K
var(X) # 7.708333
var(Y) # 9.212585
# wariancje nieznane i różne
test_a4(X, Y, 2)
test_a4(X, Y, 5)
test_a4(X, Y, 3)
test_a4(X, Y, 4)
dane <- as.matrix(read.csv("w-03-02.csv", sep=';'))
dane <- as.matrix(read.csv("w-03-03.csv", sep=';'))
dane
dane <- as.matrix(read.csv("w-03-03.csv", sep=';'))
(X <- dane[,1]) # Przed
(Y <- dane[,2]) # Po
var(X) # 7.708333
var(Y) # 9.212585
mean(X)
mean(Y)
dane <- as.matrix(read.csv("w-03-03.csv", sep=';'))
(X <- dane[,1]) # Przed
(Y <- dane[,2]) # Po
var(X) # 29.81029
var(Y) # 36.37981
# wariancje nieznane i różne
test_a4(X, Y, 0)
2 * (1 - 0.9800)
dane <- as.matrix(read.csv("w-03-03.csv", sep=';'))
(X <- dane[,1]) # Przed
(Y <- dane[,2]) # Po
var(X) # 29.81029
var(Y) # 36.37981
dane <- as.matrix(read.csv("w-03-07.csv", sep=';'))
(X <- dane[,1])
(Y <- dane[,2])
var(X)
var(Y)
mean(X), mean(Y)
mean(X); mean(Y)
length(X)
dane <- as.matrix(read.csv("w-03-07.csv", sep=';'))
(X <- dane[,1])
(Y <- dane[,2])
var(X)
var(Y)
test(X, Y, 0)
test_a4(X, Y, 0)
test_a4(Y, X, 0)
2 * (1 - 0.8008)
dane <- as.matrix(read.csv("w-03-08.csv", sep=';'))
(X <- dane[,1])
(Y <- dane[,2])
var(X)
var(Y)
test_a4(X, Y, 0)
2 * (1-0.7202)
n  <- 200
p1 <- 159 / n # K
p2 <- 138 / n # M
p  <- (n * p1 + n * p2) / (2 * n)
z <- (p1 - p2) / (sqrt(p * (1 - p) * (2/n)))
z
qnorm(0.975)
2 * (1 - pnorm(z))
2 * (1 - pnorm(z))
dane <- as.matrix(read.csv("w-03-06.csv", sep=';'))
(X <- dane[,1])
(Y <- dane[,2])
var(X)
var(Y)
test(Y, X, 200)
test_a4(Y, X, 200)
test_a4(Y, X, 210)
test_a4(Y, X, 230)
test_a4(Y, X, 220)
test_a4(Y, X, 200)
X
Y
